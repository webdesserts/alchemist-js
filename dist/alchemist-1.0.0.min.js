// Alchemist.js v1.0.0 | license: MIT
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):"object"==typeof exports?exports.Alchemist=e():t.Alchemist=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var r=n(2),i=n(1);i.use(r);var o=function(){return r};i.common=i.common=o,t.exports=i},function(t,e,n){"use strict";var r=n(3),i=n(4),o=n(5),s=n(6),c=n(7),a=n(8),u=n(9),h=u.extend();h.init=function(t){var e=s.create();t=t||{},this.white=t.white||{X:.95047,Y:1,Z:1.08883},this.spaces=e,this.BaseSpace=i.create({converter:o.create(e),precision:t.precision||9,limiter:c.create(null,null,t.limits||"nullify")})},h.use=function(t){if(a.isArray(t))for(var e=0;e<t.length;e++)this.use(t[e]);else switch("function"==typeof t&&(t=t.call(this,this)),r.identify(t)){case"space":this.attachColorSpace(t);break;case"method":this.attachColorMethod(t)}},h.attachColorSpace=function(t){var e=this.spaces.find(t.name);if(e&&e.is_concrete)throw new Error('The "'+t.name+'" plugin already exists');var n=r.serializeColorSpace(t,this.BaseSpace);this.spaces.merge(n),this.spaces.each(function(t){t.is_concrete&&(this.makeConstructorMethod(t),this.makeConversionMethod(t))},this)},h.attachColorMethod=function(t){if(t.methods.color&&this.BaseSpace[t.name])throw new Error('The method name "'+t.name+'" already exists for colors');if(t.methods.global&&this[t.name])throw new Error('The method name "'+t.name+'" already exists on alchemist');t.methods.color&&(this.BaseSpace[t.name]=t.methods.color),t.methods.global&&(this[t.name]=t.methods.global)},h.makeConstructorMethod=function(t){this[t.space]=function(e){var n;return n=arguments.length>1?Array.prototype.slice.call(arguments):e,t.create(n)}},h.makeConversionMethod=function(t){this.BaseSpace[t.space]=function(e){return this.to(t.space,e)}},h.init(),t.exports=h},function(t,e,n){var r=n(12),i=n(13),o=n(14),s=n(15),c=n(16);t.exports=[i(),r(),o(),s(),c()]},function(t,e,n){"use strict";var r=n(6),i=n(10),o=n(8),s={};s.identify=function(t){if(this.validatePlugin(t),t.to||t.from)return this.validateColorSpacePlugin(t),"space";if(t.methods)return this.validateMethodPlugin(t),"method";throw new Error("Unrecognized plugin format")},s.validatePlugin=function(t){if(!o.isObject(t))throw new Error("Expected plugin to be an object; instead got: "+t);if(!o.isString(t.name))throw new Error("Expect plguin.name to be a string; instead got: "+t.name)},s.validateColorSpacePlugin=function(t){if(!t.to&&!t.from)throw new Error('Conversions were not defined for the "'+t.name+'" colorspace plugin')},s.validateMethodPlugin=function(t){if(!t.methods.color&&!t.methods.global)throw new Error("Missing methods for method plugin");if(t.methods.color&&!o.isFunction(t.methods.color))throw new Error("Expected color method to be a function; instead got "+t.methods.color);if(t.methods.global&&!o.isFunction(t.methods.global))throw new Error("Expected color method to be a function; instead got "+t.methods.color)},s.serializeColorSpace=function(t,e){var n,s,c,a;if(!o.isString(t.name))throw new Error("color-space plugin is missing a name");n=r.create(),s=e.create({space:t.name,conversions:i.create()}),e.limits&&t.limits&&(s.limits=e.limits.create(t.limits.min,t.limits.max)),n.add(s);for(var u in t.to){if(a=t.to[u],"function"!=typeof a)throw new Error("expected "+a+" to be a function");s.conversions.add(u,t.to[u])}for(var h in t.from){if(a=t.from[h],"function"!=typeof a)throw new Error("expected "+a+" to be a function");c=e.create({space:h,"abstract":!0,conversions:i.create()}),c.conversions.add(t.name,t.from[h]),n.add(c)}return n},t.exports=s},function(t,e,n){"use strict";var r=n(8),i=n(9),o=i.extend();o.init=function(t,e){r.isPlainObject(arguments[0])?e=arguments[0]:void 0!==t&&(this.value=this.limits?this.limits.check(t):t),e=e||{},e.limiter&&(this.limits=e.limiter),e.precision&&(this.precision=e.precision),e.converter&&(this.converter=e.converter),e.conversions&&(this.conversions=e.conversions),e.space&&(this.space=e.space),this.is_concrete=!e.abstract},o.to=function(t,e){e=e||{};var n=this.as(t);return null===e.precision?n.val:n.round(e.precision)},o.as=function(t){return this.converter.convert(this,t)},o.round=function(t){return r.round(this.value,t||this.precision)},t.exports=o},function(t,e,n){"use strict";var r=n(8),i=n(9),o=i.extend();o.init=function(t){this.spaces=t},o.convert=function(t,e){var n=t.space;if(n===e)return t;if(!this.spaces.has(n))throw new Error("could not find the "+n+" color space");if(!this.spaces.has(e))throw new Error("could not find the "+e+" color space");var r=t.conversions.find(e);if("function"==typeof r)return this.applyConversion(t,e);if("string"==typeof r){var i=this.applyConversion(t,r);return this.convert(i,e)}var o=this.mapConversionPath(n,e);if(o)return this.convert(t,e);throw new Error("Alchemist does not know how to convert from "+n+" to "+e)},o.applyConversion=function(t,e){var n,i,o=t.conversions.find(e);if("function"!=typeof o)throw new TypeError("expected "+o+" to be a function");return n=null===t.value?t.value:r.isArray(t.value)?o.apply(t,r.clone(t.value)):o.call(t,r.clone(t.value)),i=this.spaces.find(e).create(n)},o.mapConversionPath=function(t,e){var n,r=this.findConversionPath(t,e);if(!r)return null;for(var i=r[e],o=r[i],s=0;100>s;){if(n=this.spaces.find(o).conversions.find(e),n&&"function"==typeof n||this.spaces.find(o).conversions.add(e,i),o===t)return i;if(!r[o])return null;i=o,o=r[o],s++}throw new Error("something went wrong while mapping the path from"+t+" to "+e)},o.findConversionPath=function(t,e){var n=[],r=[],i={};for(n.push(t),r.push(t);n.length;){var o=n.pop();if(o===e)return i;for(var s=this.spaces.findNeighbors(o),c=0;c<s.length;c++){var a=s[c];-1===r.indexOf(a)&&(i[a]=o,r.push(a),n.push(a))}}return null},t.exports=o},function(t,e,n){"use strict";var r=n(11),i=r.extend();i.add=function(t){var e=Object.getPrototypeOf(i);e.add.call(this,t.space,t)},i.findNeighbors=function(t){var e=[],n=this.find(t);if(null===n)return e;var r=n.conversions;return r.each(function(t,n){var r=this.find(n);r&&r.is_concrete&&e.push(n)},this),e},i.merge=function(t){t.each(function(t,e){var n=this.find(e);n?this.mergeSpaces(n,t):this.store[e]=t},this)},i.mergeSpaces=function(t,e){var n=!t.is_concrete&&e.is_concrete;n&&e.limits&&t.limits.merge(e.limits),t.conversions.merge(e.conversions,{force:n}),n&&(t.is_concrete=!0)},t.exports=i},function(t,e,n){"use strict";var r=n(8),i=n(9),o=i.extend();o.init=function(t,e,n){t&&(this.min=t),e&&(this.max=e),n&&(this.handler=n)},o.check=function(t){return t=this.checkBoundary("min",t),t=this.checkBoundary("max",t)},o.checkBoundary=function(t,e){var n=this[t];return e&&n&&"raw"!==this.handler?(r.each(n,function(n,r){if(this.breaks(n,e[r],t))if("clip"===this.handler)e[r]=n;else{if("nullify"===this.handler)return e=null;if("strict"===this.handler){var i="max"===this.handler?"less":"greater";throw new Error("Expected "+e[r]+" to be "+i+" than or equal to "+n)}}},this),e):e},o.breaks=function(t,e,n){return"max"===n?e>t:"min"===n?t>e:void 0},o.merge=function(t){void 0!==t.min&&(this.min=t.min),void 0!==t.max&&(this.max=t.max)},t.exports=o},function(t,e){"use strict";e.clone=function n(t){var r,i=Object(t);switch(i.constructor){case String:r=i.toString();break;case Number:r=Number(i);break;case Array:r=[],e.each(i,function(t,e){r[e]=n(t)});break;default:throw new TypeError("Alchemist does not know how to clone "+t)}return r},e.isArray=function(t){return Array.isArray(t)},e.isObject=function(t){return Boolean(t&&"object"==typeof t)},e.isFunction=function(t){return"function"==typeof t},e.isPlainObject=function(t){return t&&"[object Object]"===toString.call(t)?Object.getPrototypeOf(t)===Object.prototype:!1},e.isString=function(t){return"string"==typeof t},e.each=function(t,n,r){var i;if(r=r||null,e.isArray(t)){for(var o=t.length,s=0;o>s;s++)if(i=n.call(r,t[s],s),void 0!==i)return i}else for(var c in t)if(i=n.call(r,t[c],c),void 0!==i)return i;return null},e.round=function(t,n){if(n=n||4,e.isArray(t))for(var r=0;r<t.length;r++)t[r]=this.roundIfNumber(t[r],n);else t=e.roundIfNumber(t,n);return t},e.roundIfNumber=function(t,e){return"number"==typeof t&&(t=Number(t.toPrecision(e))),t}},function(t){function e(t){return function(e){return arr_len=t.length,t.indexOf(e)<0}}t.exports={create:function(){var t=Object.create(this);return t.init.apply(t,arguments),t},extend:function(){return Object.create(this)},init:function(){return Object.defineProperty(this,"_keep",{configurable:!0,enumerable:!1,writable:!0,value:Object.getOwnPropertyNames(this)}),this.initializer&&this.initializer.apply(this,arguments),this},reset:function(){var t=Object.keys(this);newKeys=t.filter(e(this._keep)),newKeys_len=newKeys.length;for(var n=0;newKeys_len>n;n++)delete this[newKeys[n]];return this},get proto(){return Object.getPrototypeOf(this)},set proto(t){Object.setPrototypeOf?Object.setPrototypeOf(t):this.__proto__=t}}},function(t,e,n){"use strict";var r=n(11),i=r.extend();i.merge=function(t,e){e=e||{},t.each(function(t,n){var r=this.find(n);(e.force||!r||"string"==typeof r)&&(this.store[n]=t)},this)},t.exports=i},function(t,e,n){"use strict";var r=n(8),i=n(9),o=i.extend();o.init=function(){this.store={}},o.add=function(t,e){if(this.store[t])throw new Error('the key "'+t+'" already exists in this store');this.store[t]=e},o.find=function(t){return this.store[t]||null},o.has=function(t){return Boolean(this.find(t))},o.remove=function(t){delete this.store[t]},o.each=function(t,e){return r.each.call(this,this.store,t,e)},o.merge=function(t){t.each(function(t,e){var n=this.find(e);n?n.merge(t):this.store[e]=t},this)},t.exports=o},function(t){t.exports=function(){return function(t){var e=function(t){return.04045>=t?t/12.92:Math.pow((t+.055)/1.055,2.4)},n=function(t){return.0031308>=t?12.92*t:1.055*Math.pow(t,1/2.4)-.055},r=function(t){for(var e,n,r,i,o=3,s=0,a=0,u=0;o>u;u++){e=1,n=1;for(var h=0;o>h;h++)r=h,i=o-h-1,c=u+h,c>=o&&(c-=o),e*=t[r][c],n*=t[i][c];s+=e,a-=n}return s+a},i=function(t){var e=[[],[],[]],n=1/r(t);return e[0][0]=n*(t[2][2]*t[1][1]-t[2][1]*t[1][2]),e[0][1]=-n*(t[2][2]*t[0][1]-t[2][1]*t[0][2]),e[0][2]=n*(t[1][2]*t[0][1]-t[1][1]*t[0][2]),e[1][0]=-n*(t[2][2]*t[1][0]-t[2][0]*t[1][2]),e[1][1]=n*(t[2][2]*t[0][0]-t[2][0]*t[0][2]),e[1][2]=-n*(t[1][2]*t[0][0]-t[1][0]*t[0][2]),e[2][0]=n*(t[2][1]*t[1][0]-t[2][0]*t[1][1]),e[2][1]=-n*(t[2][1]*t[0][0]-t[2][0]*t[0][1]),e[2][2]=n*(t[1][1]*t[0][0]-t[1][0]*t[0][1]),e},o=function(t,e,n,r){var o=[[t.x/t.y,e.x/e.y,n.x/n.y],[1,1,1],[(1-t.x-t.y)/t.y,(1-e.x-e.y)/e.y,(1-n.x-n.y)/n.y]],s=i(o),c=r.X*s[0][0]+r.Y*s[0][1]+r.Z*s[0][2],a=r.X*s[1][0]+r.Y*s[1][1]+r.Z*s[1][2],u=r.X*s[2][0]+r.Y*s[2][1]+r.Z*s[2][2];return o[0][0]*=c,o[0][1]*=a,o[0][2]*=u,o[1][0]*=c,o[1][1]*=a,o[1][2]*=u,o[2][0]*=c,o[2][1]*=a,o[2][2]*=u,o},s={x:.64,y:.33},a={x:.3,y:.6},u={x:.15,y:.06},h=o(s,a,u,t.white),f=i(h);return{name:"rgb",limits:{max:[255,255,255],min:[0,0,0]},to:{xyz:function(t,n,r){var i=e(t/255),o=e(n/255),s=e(r/255),c=i*h[0][0]+o*h[0][1]+s*h[0][2],a=i*h[1][0]+o*h[1][1]+s*h[1][2],u=i*h[2][0]+o*h[2][1]+s*h[2][2];return[c,a,u]}},from:{xyz:function(t,e,r){var i=255*n(t*f[0][0]+e*f[0][1]+r*f[0][2]),o=255*n(t*f[1][0]+e*f[1][1]+r*f[1][2]),s=255*n(t*f[2][0]+e*f[2][1]+r*f[2][2]);return[i,o,s]}}}}}},function(t){t.exports=function(){return{name:"xyz",to:{}}}},function(t){t.exports=function(){return{name:"hsl",limits:{max:[360,1,1],min:[0,0,0]},to:{rgb:function(t,e,n){var r,i,o,s,c;if(t/=360,0==e)return c=255*n,[c,c,c];i=.5>n?n*(1+e):n+e-n*e,r=2*n-i,s=[0,0,0];for(var a=0;3>a;a++)o=t+1/3*-(a-1),0>o&&o++,o>1&&o--,c=1>6*o?r+6*(i-r)*o:1>2*o?i:2>3*o?r+(i-r)*(2/3-o)*6:r,s[a]=255*c;return s}},from:{rgb:function(t,e,n){var r,i,o,s,c,a;return t/=255,e/=255,n/=255,s=Math.min(t,e,n),c=Math.max(t,e,n),a=c-s,c==s?r=0:t==c?r=(e-n)/a:e==c?r=2+(n-t)/a:n==c&&(r=4+(t-e)/a),r=Math.min(60*r,360),0>r&&(r+=360),o=(s+c)/2,i=c==s?0:.5>=o?a/(c+s):a/(2-c-s),[r,i,o]}}}}},function(t){t.exports=function(){return function(t){var e=216/24389,n=24389/27,r=8,i=t.white;return{name:"lab",to:{xyz:function(t,o,s){var c=(t+16)/116,a=.002*o+c,u=c-.005*s,h=a*a*a,f=u*u*u,l=h>e?h:(116*a-16)/n,p=t>r?Math.pow((t+16)/116,3):t/n,m=f>e?f:(116*u-16)/n,d=l*i.X,v=p*i.Y,y=m*i.Z;return[d,v,y]}},from:{xyz:function(t,r,o){var s=function(t){return t>e?Math.pow(t,1/3):(n*t+16)/116},c=s(t/i.X),a=s(r/i.Y),u=s(o/i.Z),h=116*a-16,f=500*(c-a),l=200*(a-u);return[h,f,l]}}}}}},function(t){t.exports=function(){return{name:"lchab",to:{lab:function(t,e,n){return a=e*Math.cos(n*Math.PI/180),b=e*Math.sin(n*Math.PI/180),[t,a,b]}},from:{lab:function(t,e,n){return C=Math.sqrt(e*e+n*n),H=180*Math.atan2(n,e)/Math.PI,0>H&&(LCHab.H+=360),[t,C,H]}}}}}])});