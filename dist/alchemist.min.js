!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.alchemist=t():e.alchemist=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var o=r(2),i=n(o),a=r(8),u=n(a);u["default"].use(i["default"]);var s=function(){return i["default"]};u["default"].common=s,e.exports=u["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(3),i=n(o),a=r(4),u=n(a),s=r(5),c=n(s),f=r(6),l=n(f),d=r(7),h=n(d);t["default"]=[u["default"](),i["default"](),c["default"](),l["default"](),h["default"]()],e.exports=t["default"]},function(e,t){"use strict";function r(){return function(e){var t=function(e){return.04045>=e?e/12.92:Math.pow((e+.055)/1.055,2.4)},r=function(e){return.0031308>=e?12.92*e:1.055*Math.pow(e,1/2.4)-.055},n=function(e){for(var t,r,n,o,i,a=3,u=0,s=0,c=0;a>c;c++){t=1,r=1;for(var f=0;a>f;f++)n=f,o=a-f-1,i=c+f,i>=a&&(i-=a),t*=e[n][i],r*=e[o][i];u+=t,s-=r}return u+s},o=function(e){var t=[[],[],[]],r=1/n(e);return t[0][0]=r*(e[2][2]*e[1][1]-e[2][1]*e[1][2]),t[0][1]=-r*(e[2][2]*e[0][1]-e[2][1]*e[0][2]),t[0][2]=r*(e[1][2]*e[0][1]-e[1][1]*e[0][2]),t[1][0]=-r*(e[2][2]*e[1][0]-e[2][0]*e[1][2]),t[1][1]=r*(e[2][2]*e[0][0]-e[2][0]*e[0][2]),t[1][2]=-r*(e[1][2]*e[0][0]-e[1][0]*e[0][2]),t[2][0]=r*(e[2][1]*e[1][0]-e[2][0]*e[1][1]),t[2][1]=-r*(e[2][1]*e[0][0]-e[2][0]*e[0][1]),t[2][2]=r*(e[1][1]*e[0][0]-e[1][0]*e[0][1]),t},i=function(e,t,r,n){var i=[[e.x/e.y,t.x/t.y,r.x/r.y],[1,1,1],[(1-e.x-e.y)/e.y,(1-t.x-t.y)/t.y,(1-r.x-r.y)/r.y]],a=o(i),u=n.X*a[0][0]+n.Y*a[0][1]+n.Z*a[0][2],s=n.X*a[1][0]+n.Y*a[1][1]+n.Z*a[1][2],c=n.X*a[2][0]+n.Y*a[2][1]+n.Z*a[2][2];return i[0][0]*=u,i[0][1]*=s,i[0][2]*=c,i[1][0]*=u,i[1][1]*=s,i[1][2]*=c,i[2][0]*=u,i[2][1]*=s,i[2][2]*=c,i},a={x:.64,y:.33},u={x:.3,y:.6},s={x:.15,y:.06},c=i(a,u,s,e.white),f=o(c);return{name:"rgb",limits:{max:[255,255,255],min:[0,0,0]},to:{xyz:function(e,r,n){var o=t(e/255),i=t(r/255),a=t(n/255),u=o*c[0][0]+i*c[0][1]+a*c[0][2],s=o*c[1][0]+i*c[1][1]+a*c[1][2],f=o*c[2][0]+i*c[2][1]+a*c[2][2];return[u,s,f]}},from:{xyz:function(e,t,n){var o=255*r(e*f[0][0]+t*f[0][1]+n*f[0][2]),i=255*r(e*f[1][0]+t*f[1][1]+n*f[1][2]),a=255*r(e*f[2][0]+t*f[2][1]+n*f[2][2]);return[o,i,a]}}}}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r,e.exports=t["default"]},function(e,t){"use strict";function r(){return{name:"xyz",to:{}}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r,e.exports=t["default"]},function(e,t){"use strict";function r(){return{name:"hsl",limits:{max:[360,1,1],min:[0,0,0]},to:{rgb:function(e,t,r){var n,o,i,a,u;if(e/=360,0==t)return u=255*r,[u,u,u];o=.5>r?r*(1+t):r+t-r*t,n=2*r-o,a=[0,0,0];for(var s=0;3>s;s++)i=e+1/3*-(s-1),0>i&&i++,i>1&&i--,u=1>6*i?n+6*(o-n)*i:1>2*i?o:2>3*i?n+(o-n)*(2/3-i)*6:n,a[s]=255*u;return a}},from:{rgb:function(e,t,r){var n,o,i,a,u,s;return e/=255,t/=255,r/=255,a=Math.min(e,t,r),u=Math.max(e,t,r),s=u-a,u==a?n=0:e==u?n=(t-r)/s:t==u?n=2+(r-e)/s:r==u&&(n=4+(e-t)/s),n=Math.min(60*n,360),0>n&&(n+=360),i=(a+u)/2,o=u==a?0:.5>=i?s/(u+a):s/(2-u-a),[n,o,i]}}}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r,e.exports=t["default"]},function(e,t){"use strict";function r(){return function(e){var t=216/24389,r=24389/27,n=8,o=e.white;return{name:"lab",to:{xyz:function(e,i,a){var u=(e+16)/116,s=.002*i+u,c=u-.005*a,f=s*s*s,l=c*c*c,d=f>t?f:(116*s-16)/r,h=e>n?Math.pow((e+16)/116,3):e/r,p=l>t?l:(116*c-16)/r,v=d*o.X,m=h*o.Y,y=p*o.Z;return[v,m,y]}},from:{xyz:function(e,n,i){var a=function(e){return e>t?Math.pow(e,1/3):(r*e+16)/116},u=a(e/o.X),s=a(n/o.Y),c=a(i/o.Z),f=116*s-16,l=500*(u-s),d=200*(s-c);return[f,l,d]}}}}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r,e.exports=t["default"]},function(e,t){"use strict";function r(){return{name:"lchab",to:{lab:function(e,t,r){var n=t*Math.cos(r*Math.PI/180),o=t*Math.sin(r*Math.PI/180);return[e,n,o]}},from:{lab:function(e,t,r){var n=Math.sqrt(t*t+r*r),o=180*Math.atan2(r,t)/Math.PI;return 0>o&&(o+=360),[e,n,o]}}}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(9),a=o(i),u=r(15),s=o(u),c=r(16),f=o(c),l=r(10),d=o(l),h=r(17),p=o(h),v=r(12),m=n(v),y=r(13),b=o(y),_=b["default"].extend();_.init=function(e){var t=d["default"].create();e=e||{},this.white=e.white||{X:.95047,Y:1,Z:1.08883},this.spaces=t,this.BaseSpace=s["default"].create({converter:f["default"].create(t),precision:e.precision||9,limiter:p["default"].create(null,null,e.limits||"nullify")})},_.use=function(e){if(m.isArray(e))for(var t=0;t<e.length;t++)this.use(e[t]);else switch("function"==typeof e&&(e=e.call(this,this)),a["default"].identify(e)){case"space":this.attachColorSpace(e);break;case"method":this.attachColorMethod(e)}},_.attachColorSpace=function(e){var t=this,r=this.spaces.find(e.name);if(r&&r.is_concrete)throw new Error('The "'+e.name+'" plugin already exists');var n=a["default"].serializeColorSpace(e,this.BaseSpace);this.spaces.merge(n),this.spaces.each(function(e){e.is_concrete&&(t.makeConstructorMethod(e),t.makeConversionMethod(e))})},_.attachColorMethod=function(e){if(e.methods.color&&this.BaseSpace[e.name])throw new Error('The method name "'+e.name+'" already exists for colors');if(e.methods.global&&this[e.name])throw new Error('The method name "'+e.name+'" already exists on alchemist');e.methods.color&&(this.BaseSpace[e.name]=e.methods.color),e.methods.global&&(this[e.name]=e.methods.global)},_.makeConstructorMethod=function(e){this[e.space]=function(t){var r;return r=arguments.length>1?Array.prototype.slice.call(arguments):t,e.create(r)}},_.makeConversionMethod=function(e){this.BaseSpace[e.space]=function(t){return this.to(e.space,t)}},_.init(),t["default"]=_,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(10),a=o(i),u=r(14),s=o(u),c=r(12),f=n(c),l={};l.identify=function(e){if(this.validatePlugin(e),e.to||e.from)return this.validateColorSpacePlugin(e),"space";if(e.methods)return this.validateMethodPlugin(e),"method";throw new Error("Unrecognized plugin format")},l.validatePlugin=function(e){if(!f.isObject(e))throw new Error("Expected plugin to be an object; instead got: "+e);if(!f.isString(e.name))throw new Error("Expect plguin.name to be a string; instead got: "+e.name)},l.validateColorSpacePlugin=function(e){if(!e.to&&!e.from)throw new Error('Conversions were not defined for the "'+e.name+'" colorspace plugin')},l.validateMethodPlugin=function(e){if(!e.methods.color&&!e.methods.global)throw new Error("Missing methods for method plugin");if(e.methods.color&&!f.isFunction(e.methods.color))throw new Error("Expected color method to be a function; instead got "+e.methods.color);if(e.methods.global&&!f.isFunction(e.methods.global))throw new Error("Expected color method to be a function; instead got "+e.methods.color)},l.serializeColorSpace=function(e,t){var r,n,o,i;if(!f.isString(e.name))throw new Error("color-space plugin is missing a name");r=a["default"].create(),n=t.create({space:e.name,conversions:s["default"].create()}),t.limits&&e.limits&&(n.limits=t.limits.create(e.limits.min,e.limits.max)),r.add(n);for(var u in e.to){if(i=e.to[u],"function"!=typeof i)throw new Error("expected "+i+" to be a function");n.conversions.add(u,e.to[u])}for(var c in e.from){if(i=e.from[c],"function"!=typeof i)throw new Error("expected "+i+" to be a function");o=t.create({space:c,"abstract":!0,conversions:s["default"].create()}),o.conversions.add(e.name,e.from[c]),r.add(o)}return r},t["default"]=l,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(11),i=n(o),a=i["default"].extend();a.add=function(e){var t=Object.getPrototypeOf(a);t.add.call(this,e.space,e)},a.findNeighbors=function(e){var t=this,r=[],n=this.find(e);if(null===n)return r;var o=n.conversions;return o.each(function(e,n){var o=t.find(n);o&&o.is_concrete&&r.push(n)}),r},a.merge=function(e){var t=this;e.each(function(e,r){var n=t.find(r);n?t.mergeSpaces(n,e):t.store[r]=e})},a.mergeSpaces=function(e,t){var r=!e.is_concrete&&t.is_concrete;r&&t.limits&&e.limits.merge(t.limits),e.conversions.merge(t.conversions,{force:r}),r&&(e.is_concrete=!0)},t["default"]=a,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0});var i=r(12),a=o(i),u=r(13),s=n(u),c=s["default"].extend();c.init=function(){this.store={}},c.add=function(e,t){if(this.store[e])throw new Error('the key "'+e+'" already exists in this store');this.store[e]=t},c.find=function(e){return this.store[e]||null},c.has=function(e){return Boolean(this.find(e))},c.remove=function(e){delete this.store[e]},c.each=function(e,t){return a.each.call(this,this.store,e,t)},c.merge=function(e){e.each(function(e,t){var r=this.find(t);r?r.merge(e):this.store[t]=e},this)},t["default"]=c,e.exports=t["default"]},function(e,t){"use strict";function r(e){var t,n=Object(e);switch(n.constructor){case String:t=n.toString();break;case Number:t=Number(n);break;case Array:t=[],s(n,function(e,n){t[n]=r(e)});break;default:throw new TypeError("Alchemist does not know how to clone "+e)}return t}function n(e){return Array.isArray(e)}function o(e){return Boolean(e&&"object"==typeof e)}function i(e){return"function"==typeof e}function a(e){return e&&"[object Object]"===toString.call(e)?Object.getPrototypeOf(e)===Object.prototype:!1}function u(e){return"string"==typeof e}function s(e,t,r){var o;if(r=r||null,n(e)){for(var i=e.length,a=0;i>a;a++)if(o=t.call(r,e[a],a),void 0!==o)return o}else for(var u in e)if(o=t.call(r,e[u],u),void 0!==o)return o;return null}function c(e,t){if(t=t||4,n(e))for(var r=0;r<e.length;r++)e[r]=this.roundIfNumber(e[r],t);else e=f(e,t);return e}function f(e,t){return"number"==typeof e&&(e=Number(e.toPrecision(t))),e}Object.defineProperty(t,"__esModule",{value:!0}),t.clone=r,t.isArray=n,t.isObject=o,t.isFunction=i,t.isPlainObject=a,t.isString=u,t.each=s,t.round=c,t.roundIfNumber=f},function(e,t){"use strict";function r(e){return function(t){return arr_len=e.length,e.indexOf(t)<0}}e.exports=Object.defineProperties({create:function(){var e=Object.create(this);return e.init.apply(e,arguments),e},extend:function(){return Object.create(this)},init:function(){return Object.defineProperty(this,"_keep",{configurable:!0,enumerable:!1,writable:!0,value:Object.getOwnPropertyNames(this)}),this.initializer&&this.initializer.apply(this,arguments),this},reset:function(){var e=Object.keys(this);newKeys=e.filter(r(this._keep)),newKeys_len=newKeys.length;for(var t=0;t<newKeys_len;t++)delete this[newKeys[t]];return this}},{proto:{get:function(){return Object.getPrototypeOf(this)},set:function(e){Object.setPrototypeOf?Object.setPrototypeOf(e):this.__proto__=e},configurable:!0,enumerable:!0}})},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(11),i=n(o),a=i["default"].extend();a.merge=function(e,t){t=t||{},e.each(function(e,r){var n=this.find(r);(t.force||!n||"string"==typeof n)&&(this.store[r]=e)},this)},t["default"]=a,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0});var i=r(12),a=o(i),u=r(13),s=n(u),c=s["default"].extend();c.init=function(e,t){a.isPlainObject(arguments[0])?t=arguments[0]:void 0!==e&&(this.limits?this.value=this.limits.check(e):this.value=e),t=t||{},t.limiter&&(this.limits=t.limiter),t.precision&&(this.precision=t.precision),t.converter&&(this.converter=t.converter),t.conversions&&(this.conversions=t.conversions),t.space&&(this.space=t.space),this.is_concrete=!t["abstract"]},c.to=function(e,t){t=t||{};var r=this.as(e);return null===t.precision?r.val:r.round(t.precision)},c.as=function(e){return this.converter.convert(this,e)},c.round=function(e){return a.round(this.value,e||this.precision)},t["default"]=c,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0});var i=r(12),a=o(i),u=r(13),s=n(u),c=s["default"].extend();c.init=function(e){this.spaces=e},c.convert=function(e,t){var r=e.space;if(r===t)return e;if(!this.spaces.has(r))throw new Error("could not find the "+r+" color space");if(!this.spaces.has(t))throw new Error("could not find the "+t+" color space");var n=e.conversions.find(t);if("function"==typeof n)return this.applyConversion(e,t);if("string"==typeof n){var o=this.applyConversion(e,n);return this.convert(o,t)}var i=this.mapConversionPath(r,t);if(i)return this.convert(e,t);throw new Error("Alchemist does not know how to convert from "+r+" to "+t)},c.applyConversion=function(e,t){var r,n,o=e.conversions.find(t);if("function"!=typeof o)throw new TypeError("expected "+o+" to be a function");return r=null===e.value?e.value:a.isArray(e.value)?o.apply(e,a.clone(e.value)):o.call(e,a.clone(e.value)),n=this.spaces.find(t).create(r)},c.mapConversionPath=function(e,t){var r,n=this.findConversionPath(e,t);if(!n)return null;for(var o=n[t],i=n[o],a=0;100>a;){if(r=this.spaces.find(i).conversions.find(t),r&&"function"==typeof r||this.spaces.find(i).conversions.add(t,o),i===e)return o;if(!n[i])return null;o=i,i=n[i],a++}throw new Error("something went wrong while mapping the path from"+e+" to "+t)},c.findConversionPath=function(e,t){var r=[],n=[],o={};for(r.push(e),n.push(e);r.length;){var i=r.pop();if(i===t)return o;for(var a=this.spaces.findNeighbors(i),u=0;u<a.length;u++){var s=a[u];-1===n.indexOf(s)&&(o[s]=i,n.push(s),r.push(s))}}return null},t["default"]=c,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0});var i=r(12),a=o(i),u=r(13),s=n(u),c=s["default"].extend();c.init=function(e,t,r){e&&(this.min=e),t&&(this.max=t),r&&(this.handler=r)},c.check=function(e){return e=this.checkBoundary("min",e),e=this.checkBoundary("max",e)},c.checkBoundary=function(e,t){var r=this[e];return t&&r&&"raw"!==this.handler?(a.each(r,function(r,n){if(this.breaks(r,t[n],e))if("clip"===this.handler)t[n]=r;else{if("nullify"===this.handler)return t=null;if("strict"===this.handler){var o="max"===this.handler?"less":"greater";throw new Error("Expected "+t[n]+" to be "+o+" than or equal to "+r)}}},this),t):t},c.breaks=function(e,t,r){return"max"===r?t>e:"min"===r?e>t:void 0},c.merge=function(e){void 0!==e.min&&(this.min=e.min),void 0!==e.max&&(this.max=e.max)},t["default"]=c,e.exports=t["default"]}])});