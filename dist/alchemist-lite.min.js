!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.alchemist=t():e.alchemist=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),i=n(o);t["default"]=i["default"],e.exports=t["default"]},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(3),s=o(i),a=r(9),u=o(a),c=r(10),f=o(c),l=r(4),d=o(l),h=r(11),p=o(h),v=r(6),m=n(v),y=r(7),b=o(y),g=b["default"].extend();g.init=function(e){var t=d["default"].create();e=e||{},this.white=e.white||{X:.95047,Y:1,Z:1.08883},this.spaces=t,this.BaseSpace=u["default"].create({converter:f["default"].create(t),precision:e.precision||9,limiter:p["default"].create(null,null,e.limits||"nullify")})},g.use=function(e){if(m.isArray(e))for(var t=0;t<e.length;t++)this.use(e[t]);else switch("function"==typeof e&&(e=e.call(this,this)),s["default"].identify(e)){case"space":this.attachColorSpace(e);break;case"method":this.attachColorMethod(e)}},g.attachColorSpace=function(e){var t=this,r=this.spaces.find(e.name);if(r&&r.is_concrete)throw new Error('The "'+e.name+'" plugin already exists');var n=s["default"].serializeColorSpace(e,this.BaseSpace);this.spaces.merge(n),this.spaces.each(function(e){e.is_concrete&&(t.makeConstructorMethod(e),t.makeConversionMethod(e))})},g.attachColorMethod=function(e){if(e.methods.color&&this.BaseSpace[e.name])throw new Error('The method name "'+e.name+'" already exists for colors');if(e.methods.global&&this[e.name])throw new Error('The method name "'+e.name+'" already exists on alchemist');e.methods.color&&(this.BaseSpace[e.name]=e.methods.color),e.methods.global&&(this[e.name]=e.methods.global)},g.makeConstructorMethod=function(e){this[e.space]=function(t){var r;return r=arguments.length>1?Array.prototype.slice.call(arguments):t,e.create(r)}},g.makeConversionMethod=function(e){this.BaseSpace[e.space]=function(t){return this.to(e.space,t)}},g.init(),t["default"]=g,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(4),s=o(i),a=r(8),u=o(a),c=r(6),f=n(c),l={};l.identify=function(e){if(this.validatePlugin(e),e.to||e.from)return this.validateColorSpacePlugin(e),"space";if(e.methods)return this.validateMethodPlugin(e),"method";throw new Error("Unrecognized plugin format")},l.validatePlugin=function(e){if(!f.isObject(e))throw new Error("Expected plugin to be an object; instead got: "+e);if(!f.isString(e.name))throw new Error("Expect plguin.name to be a string; instead got: "+e.name)},l.validateColorSpacePlugin=function(e){if(!e.to&&!e.from)throw new Error('Conversions were not defined for the "'+e.name+'" colorspace plugin')},l.validateMethodPlugin=function(e){if(!e.methods.color&&!e.methods.global)throw new Error("Missing methods for method plugin");if(e.methods.color&&!f.isFunction(e.methods.color))throw new Error("Expected color method to be a function; instead got "+e.methods.color);if(e.methods.global&&!f.isFunction(e.methods.global))throw new Error("Expected color method to be a function; instead got "+e.methods.color)},l.serializeColorSpace=function(e,t){var r,n,o,i;if(!f.isString(e.name))throw new Error("color-space plugin is missing a name");r=s["default"].create(),n=t.create({space:e.name,conversions:u["default"].create()}),t.limits&&e.limits&&(n.limits=t.limits.create(e.limits.min,e.limits.max)),r.add(n);for(var a in e.to){if(i=e.to[a],"function"!=typeof i)throw new Error("expected "+i+" to be a function");n.conversions.add(a,e.to[a])}for(var c in e.from){if(i=e.from[c],"function"!=typeof i)throw new Error("expected "+i+" to be a function");o=t.create({space:c,"abstract":!0,conversions:u["default"].create()}),o.conversions.add(e.name,e.from[c]),r.add(o)}return r},t["default"]=l,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(5),i=n(o),s=i["default"].extend();s.add=function(e){var t=Object.getPrototypeOf(s);t.add.call(this,e.space,e)},s.findNeighbors=function(e){var t=this,r=[],n=this.find(e);if(null===n)return r;var o=n.conversions;return o.each(function(e,n){if("string"!=typeof e){var o=t.find(n);o&&o.is_concrete&&r.push(n)}}),r},s.merge=function(e){var t=this;e.each(function(e,r){var n=t.find(r);n?t.mergeSpaces(n,e):t.store[r]=e})},s.mergeSpaces=function(e,t){var r=!e.is_concrete&&t.is_concrete;r&&t.limits&&e.limits.merge(t.limits),e.conversions.merge(t.conversions,{force:r}),r&&(e.is_concrete=!0)},t["default"]=s,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0});var i=r(6),s=o(i),a=r(7),u=n(a),c=u["default"].extend();c.init=function(){this.store={}},c.add=function(e,t){if(this.store[e])throw new Error('the key "'+e+'" already exists in this store');this.store[e]=t},c.find=function(e){return this.store[e]||null},c.has=function(e){return Boolean(this.find(e))},c.remove=function(e){delete this.store[e]},c.each=function(e,t){return s.each.call(this,this.store,e,t)},c.merge=function(e){e.each(function(e,t){var r=this.find(t);r?r.merge(e):this.store[t]=e},this)},t["default"]=c,e.exports=t["default"]},function(e,t){"use strict";function r(e){var t,n=Object(e);switch(n.constructor){case String:t=n.toString();break;case Number:t=Number(n);break;case Array:t=[],u(n,function(e,n){t[n]=r(e)});break;default:throw new TypeError("Alchemist does not know how to clone "+e)}return t}function n(e){return Array.isArray(e)}function o(e){return Boolean(e&&"object"==typeof e)}function i(e){return"function"==typeof e}function s(e){return e&&"[object Object]"===toString.call(e)?Object.getPrototypeOf(e)===Object.prototype:!1}function a(e){return"string"==typeof e}function u(e,t,r){var o;if(r=r||null,n(e)){for(var i=e.length,s=0;i>s;s++)if(o=t.call(r,e[s],s),void 0!==o)return o}else for(var a in e)if(o=t.call(r,e[a],a),void 0!==o)return o;return null}function c(e,t){if(t=t||4,n(e))for(var r=0;r<e.length;r++)e[r]=this.roundIfNumber(e[r],t);else e=f(e,t);return e}function f(e,t){return"number"==typeof e&&(e=Number(e.toPrecision(t))),e}Object.defineProperty(t,"__esModule",{value:!0}),t.clone=r,t.isArray=n,t.isObject=o,t.isFunction=i,t.isPlainObject=s,t.isString=a,t.each=u,t.round=c,t.roundIfNumber=f},function(e,t){"use strict";function r(e){return function(t){return arr_len=e.length,e.indexOf(t)<0}}e.exports=Object.defineProperties({create:function(){var e=Object.create(this);return e.init.apply(e,arguments),e},extend:function(){return Object.create(this)},init:function(){return Object.defineProperty(this,"_keep",{configurable:!0,enumerable:!1,writable:!0,value:Object.getOwnPropertyNames(this)}),this.initializer&&this.initializer.apply(this,arguments),this},reset:function(){var e=Object.keys(this);newKeys=e.filter(r(this._keep)),newKeys_len=newKeys.length;for(var t=0;t<newKeys_len;t++)delete this[newKeys[t]];return this}},{proto:{get:function(){return Object.getPrototypeOf(this)},set:function(e){Object.setPrototypeOf?Object.setPrototypeOf(e):this.__proto__=e},configurable:!0,enumerable:!0}})},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(5),i=n(o),s=i["default"].extend();s.merge=function(e,t){t=t||{},e.each(function(e,r){var n=this.find(r);(t.force||!n||"string"==typeof n)&&(this.store[r]=e)},this)},t["default"]=s,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0});var i=r(6),s=o(i),a=r(7),u=n(a),c=u["default"].extend();c.init=function(e,t){s.isPlainObject(arguments[0])?t=arguments[0]:void 0!==e&&(this.limits?this.value=this.limits.check(e):this.value=e),t=t||{},t.limiter&&(this.limits=t.limiter),t.precision&&(this.precision=t.precision),t.converter&&(this.converter=t.converter),t.conversions&&(this.conversions=t.conversions),t.space&&(this.space=t.space),this.is_concrete=!t["abstract"]},c.to=function(e,t){t=t||{};var r=this.as(e);return null===t.precision?r.val:r.round(t.precision)},c.as=function(e){return this.converter.convert(this,e)},c.round=function(e){return s.round(this.value,e||this.precision)},t["default"]=c,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0});var i=r(6),s=o(i),a=r(7),u=n(a),c=u["default"].extend();c.init=function(e){this.spaces=e},c.convert=function(e,t){var r=e.space;if(r===t)return e;if(!this.spaces.has(r))throw new Error("could not find the "+r+" color space");if(!this.spaces.has(t))throw new Error("could not find the "+t+" color space");var n=e.conversions.find(t);if("function"==typeof n)return this.applyConversion(e,t);if("string"==typeof n){var o=this.applyConversion(e,n);return this.convert(o,t)}var i=this.mapConversionPath(r,t);if(i)return this.convert(e,t);throw new Error("Alchemist does not know how to convert from "+r+" to "+t)},c.applyConversion=function(e,t){var r,n,o=e.conversions.find(t);if("function"!=typeof o)throw new TypeError("expected "+o+" to be a function but instead was a "+typeof o);return r=null===e.value?e.value:s.isArray(e.value)?o.apply(e,s.clone(e.value)):o.call(e,s.clone(e.value)),n=this.spaces.find(t).create(r)},c.mapConversionPath=function(e,t){var r,n=this.findConversionPath(e,t);if(!n)return null;for(var o=n[t],i=n[o],s=0;100>s;){if(r=this.spaces.find(i).conversions.find(t),r||this.spaces.find(i).conversions.add(t,o),i===e)return o;if(!n[i])return null;o=i,i=n[i],s++}throw new Error("something went wrong while mapping the path from"+e+" to "+t)},c.findConversionPath=function(e,t){var r=[],n=[],o={};for(r.push(e),n.push(e);r.length;){var i=r.pop();if(i===t)return o;for(var s=this.spaces.findNeighbors(i),a=0;a<s.length;a++){var u=s[a];-1===n.indexOf(u)&&(o[u]=i,n.push(u),r.push(u))}}return null},t["default"]=c,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0});var i=r(6),s=o(i),a=r(7),u=n(a),c=u["default"].extend();c.init=function(e,t,r){e&&(this.min=e),t&&(this.max=t),r&&(this.handler=r)},c.check=function(e){return e=this.checkBoundary("min",e),e=this.checkBoundary("max",e)},c.checkBoundary=function(e,t){var r=this[e];return t&&r&&"raw"!==this.handler?(s.each(r,function(r,n){if(this.breaks(r,t[n],e))if("clip"===this.handler)t[n]=r;else{if("nullify"===this.handler)return t=null;if("strict"===this.handler){var o="max"===this.handler?"less":"greater";throw new Error("Expected "+t[n]+" to be "+o+" than or equal to "+r)}}},this),t):t},c.breaks=function(e,t,r){return"max"===r?t>e:"min"===r?e>t:void 0},c.merge=function(e){void 0!==e.min&&(this.min=e.min),void 0!==e.max&&(this.max=e.max)},t["default"]=c,e.exports=t["default"]}])});